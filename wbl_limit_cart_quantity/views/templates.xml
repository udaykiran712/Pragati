<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="wbl_product_view_limit_cart_qty" inherit_id="website_sale.product">
        <xpath expr="//div[@id='o_wsale_cta_wrapper']" position="after">
            <div t-if="product.min_sale_qty or product.max_sale_qty" id="wbl-min-max-limit-block" class="text-warning fw-bold">
                <span t-if="product.min_sale_qty">Minimum <t t-esc="product.min_sale_qty"/> quantity allowed in a cart.</span><br/>
                <span t-if="product.max_sale_qty">Maximum <t t-esc="product.max_sale_qty"/> quantity allowed in a cart.</span>
            </div>
        </xpath>
    </template>

    <template id="wbl_product_min_max_qty_limit_error" inherit_id="website_sale.product_quantity">
        <xpath expr="//input[@name='add_qty']" position="replace">
            <input type="text" class="form-control quantity text-center" t-att-data-min="product.min_sale_qty or 1" t-att-data-max="product.max_sale_qty" name="add_qty" t-att-value="product.min_sale_qty or 1"/>
        </xpath>
        <xpath expr="//div[@id='product_detail_main']" position="before">
            <div class="modal fade" id="wbl-min-max-order-qty-modal" tabindex="-1" role="dialog" aria-labelledby="wbl-min-max-order-qty-modal" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title" id="wbl-modal-title">Warning!</h2>
                            <a href="#" class="close pull-right wbl-close-modal" data-dismiss="modal" style="text-decoration:none; font-size:30px">×</a>
                        </div>
                        <div class="modal-body" id="wbl-min-max-qty-limit-error">Something went wrong</div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary wbl-close-modal" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </xpath>
    </template>

    <template id="wbl_cart_item_qty_min_max_limit" inherit_id="website_sale.cart_lines">
        <xpath expr="//input[@t-att-data-line-id='line.id']" position="replace">
            <input type="text" class="js_quantity form-control quantity" t-att-data-line-id="line.id" t-att-data-product-id="line.product_id.id" t-att-data-min="line.product_id.min_sale_qty" t-att-data-max="line.product_id.max_sale_qty" t-att-value="int(line.product_uom_qty) == line.product_uom_qty and int(line.product_uom_qty) or line.product_uom_qty" />
        </xpath>
        <xpath expr="//table[@id='cart_products']" position="before">
            <div class="modal fade" id="wbl-min-max-order-qty-modal" tabindex="-1" role="dialog" aria-labelledby="wbl-min-max-order-qty-modal" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2 class="modal-title" id="wbl-modal-title">Warning!</h2>
                            <a href="#" class="close pull-right wbl-close-modal" data-dismiss="modal" style="text-decoration:none; font-size:30px">×</a>
                        </div>
                        <div class="modal-body" id="wbl-min-max-qty-limit-error">Something went wrong</div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary wbl-close-modal" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </xpath>
    </template>

    <template id="wbl_cart_item_qty_min_max_limit_modal" inherit_id="sale_product_configurator.product_quantity_config">
        <xpath expr="//input[@name='add_qty']" position="replace">
            <input type="text" class="js_quantity form-control quantity text-center" style="max-width: 4rem" t-att-data-min="product.min_sale_qty" t-att-data-max="product.max_sale_qty" name="add_qty" t-att-value="product.min_sale_qty"/>
        </xpath>
    </template>
</odoo>
